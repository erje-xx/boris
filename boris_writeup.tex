\documentclass{article}
\usepackage{amssymb,amsmath}
\usepackage{graphicx}
\title{boris}

\begin{document}
\maketitle
\begin{abstract}
boris is a python module which calculates the dispersion characteristics of spin waves (SW) in ferromagnetic films based on the perturbation theory of Kalinikos and Slavin (K\&{}S). Additionally, by calculating contours of the dispersion surface and via an inverse Fourier transform, boris calculates the emission pattern of a SW point source contacting a ferromagnetic medium. 
\end{abstract}
\section{Introduction}
More than a decade ago \cite{SD_kaiser_2000}, the diffraction of spin-waves in tangentially magnetized yttrium iron garnet (YIG) films was experimentally studied via Brillouin light scattering. 
Spin-waves were excited in YIG films of moderate thickness, 5--7 $\mu$m, by a microstrip-transducer with an input antenna of width 50 $\mu$m and length 2.5 mm. 
Linear effects, such as unidirectional excitation of magnetostatic surface waves (MSSW) and angular confinement of energy propagation of backward volume magnetostatic waves (BVMSW) were investigated. 
Moreover, non-linear effects, such as the self-focusing of a stationary BVMSW beam at a point, as well as space-time self-focusing of a finite-duration (nonstationary) BVMSW pulse were observed. 
The formation of strongly localized two-dimensional wave packets (``spin-wave bullets") was also observed.

In recent years, related studies have been carried out in $\text{Ni}_{81}\text{Fe}_{19}$ films, for technological reasons. 
The radiation of spin-waves from a waveguide, excited by a stripe antenna, into an unbounded $\text{Ni}_{81}\text{Fe}_{19}$ film \cite{VS_texas}, as well as the diffraction of spin-waves from a defect within a waveguide \cite{VS_texas_apl}, were experimentally observed. 
Finally, the radiation of spin-waves from a spin torque nano-oscillator (STNO) contacting an unbounded $\text{Ni}_{81}\text{Fe}_{19}$ film was experimentally studied \cite{VSS_stno}.

In particular, the emission of spin-waves from the STNO \cite{VSS_stno} displayed an intriguing directional character; the wave packet was steerable by the direction of the static saturating field. 
Meanwhile, in YIG, it was shown that the radiation of spin-waves from a one-dimensional wave source, actually also a waveguide contacting a larger film, can excite nondiffractive wave beams \cite{thomas}.

These experiments investigated primarily point defects and wave sources, although it is possible to study arbitrarily shaped defects and wave sources, whose emission characteristics may strongly vary from those of points sources. 
This reduces to the study of convolution integrals of the point source radiation patterns (i.e. the 2D Green's functions of magnetostatic waves).

First, we develop an approach based on a dispersion relation derived from a perturbation theory to calculate spin-wave radiation patterns. 
Then, we turn to the problem of determining the 2D Green's function for non-exchange magnetostatic waves. 
Next, we find the 2D Green's function for exchange magnetostatic waves. 
Lastly, we consider approaches to include damping in the calculations.
%
%
%
%
\section{Preliminaries}
K\&{}S \cite{K_1980, KS_1986} have solved Maxwell's equation in the magnetostatic limit for a medium described by the linearised Landau-Lifshitz equation, subject to electromagnetic and ``exchange" boundary conditions. Using perturbation theory, K\&{}S have obtained an explicit dispersion relation for ``spin-waves" in the medium. To wit,
\begin{equation}\label{dispersion_main}
\omega_{n} = \sqrt{(\omega_{H} + \alpha \omega_{M} k_{n}^2)(\omega_{H} + \alpha \omega_{M} k_{n}^2 + \omega_{M} F_{nn})}
\end{equation}
where
\begin{equation}
F_{nn} = P_{nn} + \sin^2{\theta} \left(1 - P_{nn} \left( 1 + \cos^2{\phi}\right) + \omega_{M} \frac{P_{nn}(1-P_{nn})\sin^2{\phi}}{(\omega_{H} + \alpha \omega_{M} k_{n}^2)} \right),
\end{equation}
$k_{n}^2 = k_{\zeta}^2 + \kappa_{n}^2$, and $\kappa_{n} = \frac{n \pi}{L}$ where $L$ is the film thickness. K\&{}S defined $\omega_{H} = \mu_{0} |g| H_{i}$ and $\omega_{M} = \mu_{0} |g| M_{0}$, where $\mu_{0}$ is the permeability of vacuum, $|g|$ is the gyromagnetic ratio, $H_{i}$ is the magnitude of the internal field, and $M_{0}$ is the magnitude of the saturation magnetization. The constant $\alpha$ is the exchange constant.

We rely on the approximation of totally unpinnned surface spins, for which $P_{nn}$ has the explicit expression
\begin{equation}
P_{nn} = \frac{k_{\zeta}^2}{k_{n}^2} - \frac{k_{\zeta}^4}{k_{n}^4} F_{n} \frac{1}{(1 + \delta_{0n})}
\end{equation}
whereby
\begin{equation}
F_{n} = \frac{2}{k_{\zeta}L} [1 - (-1)^n e^{-k_{\zeta}L}].
\end{equation}
We write $P_{nn}$ in the diagonal approximation, having taken $n = n^{\prime}$. 
Lastly, we exclusively consider modes with a uniform profile across the film thickness, i.e. everywhere $n = 0$.

K\&{}S utilize two coordinate systems. The first $(\xi,\eta,\zeta)$ system is oriented such that the $\xi$ direction lies parallel to the film normal vector, if the film is considered as a plane with $L=0$. The upper and lower surfaces of the film lie at $\xi = \frac{L}{2}$ and $\xi = \frac{-L}{2}$, respectively. Furthermore, the direction of spin-wave propagation is oriented along the $\zeta$ direction, i.e. $\vec{k} \parallel \hat{\zeta}$. The second $(x,y,z)$ system is oriented such that the $z$ axis lies parallel to the saturation magnetization $\vec{M}_{0}$ and the internal static magnetic field $\vec{H}_{i}$. The angle $\theta$ measures the rotation of the $z$ axis relative to the $\xi$ axis and takes values in the range $[0,\pi]$. The angle $\phi$ measures the rotation of the $z$ axis relative to the $\zeta$ axis and takes values in the range $[0, 2 \pi]$. If $\theta = \frac{\pi}{2}$, $\vec{M}_{0}$ lies ``in-plane". If then $\phi = 0$, then $\hat{z} \parallel \hat{\zeta}$, i.e. $\vec{M}_{0} \parallel \vec{k}$. If instead $\phi = \frac{\pi}{2}$, then $\hat{z} \parallel \hat{\eta}$, i.e. $\vec{M}_{0} \perp \vec{k}$. Note that, by choosing the orientation of the axes, $\vec{k} = (0,0,k_{\zeta})$ in the $(\xi,\eta,\zeta)$ coordinate system.

We consider the physical quantities $\omega_{H}$, $\omega_{M}$, $\alpha$, and $L$ to be fixed. Then, for ``in-plane" oriented magnetization, i.e. for fixed $\theta = \frac{\pi}{2}$, equation \eqref{dispersion_main} defines a spin-wave dispersion surface $\omega_{n} \left(k_{\parallel} , k_{\perp} \right) = \omega_{n} (\vec{k})$. We have written $\left( k_{\parallel}, k_{\perp} \right)$ in place of $\left( k_{z} , k_{y} \right)$ to denote the components of $\vec{k}$ relative to the internal static magnetic field.

A dispersion relation connects time oscillations $e^{i \omega t}$ to spatial oscillations $e^{i \vec{k} \cdot \vec{r}}$ of wave number $\vec{k} = (\frac{2 \pi}{\lambda_{\parallel}}, \frac{2 \pi}{\lambda_{\perp}})$. The dispersion relation is the function $\omega (\vec{k})$ for which the plane waves $e^{i \vec{k} \cdot \vec{r}} e^{i \omega (\vec{k}) t}$ satisfy the systems of equations.

Suppose we excite magnetostatic waves with a harmonically varying magnetic field of circular frequency $\omega_{ex}$. The spatial profile of the excited magnetostatic waves then arises from waves satisfying 
\begin{equation}\label{slowness_surface}
\omega_{n} (\vec{k}) = \omega_{ex}. 
\end{equation}
Equation \eqref{slowness_surface} defines a constant frequency contour of the dispersion surface. For harmonic excitation of a non-dissipative system, we may calculate the spatial profile of excited magnetostatic waves by investigating contours of the dispersion surface.

Even with ideally harmonic excitation, dissipation introduces coupling between the eigenmodes of an oscillating system. An external harmonically varying magnetic field excites oscillations not only at circular frequency $\omega_{ex}$, but also within a narrow range $[\omega_{ex} - \frac{\Delta \omega}{2}, \omega_{ex} + \frac{\Delta \omega}{2}]$ whose characteristic width $\Delta \omega$ is proportional to the dissipation of the system. For magnetostatic waves, dissipation is phenomenologically modelled via the Gilbert damping parameter $\alpha$, i.e. $\Delta \omega \propto \alpha$.

With dissipation present, the spatial profile of magnetostatic waves excited by a harmonic magnetic field of frequency $\omega_{ex}$ is not synthesized from a contour of the dispersion surface, but rather from a family of contours on the dispersion surface with frequences in the range $[\omega_{ex} - \frac{\Delta \omega}{2}, \omega_{ex} + \frac{\Delta \omega}{2}]$. The weights, or the amplitudes, $F(\vec{k})$ in the synthesis are inversely proportional to $| \omega_{ex} - \omega_{n} (\vec{k}) |$.

\subsection{Group velocity}
We derive the group velocity,
\begin{equation}
\vec{v}_{g} = \nabla_{\vec{k}} \omega_{n} (\vec{k}) = \frac{\partial \omega_{n}}{\partial k_{\zeta}} \hat{k}_{\zeta} + \frac{1}{k_{\zeta}} \frac{\partial \omega_{n}}{\partial \phi} \hat{\phi}
\end{equation}
first in polar coordinates. 
Direction of energy propagation parallel to group velocity. Non-collinearity of phase and group velocity. Semi-caustics and caustics.

\subsection{Magnon effective mass}
Corpuscular picture, magnons. The magnon inverse effective mass tensor has elements,
\begin{equation}
\left(\frac{1}{m}\right)_{\parallel , \perp} = \frac{1}{\hbar} \frac{\partial^2 \omega_{n}}{\partial k_{\parallel} \partial k_{\perp}}.
\end{equation}
Note that, besides the factor $\frac{1}{\hbar}$, the magnon inverse effective mass tensor is the Hessian matrix of $\omega_{n} ( k_{\parallel} , k_{\perp} )$.

\subsection{Density of modes/states}
Caustic direction corresponds to minimum magnon effective mass ($\rightarrow$ 0?).

\section{Steering magnetostatic waves}
Wave sources.

Phase dispersion. Anisotropic dispersion (origin: (bi-)gyrotopy). Caustics (or semi-caustics).

\subsection{Real-space wave source patterning}
Control of real-space wave source distribution. The excitation of waves in an unbounded medium supporting spin waves contacted by a wave source is modelled by convolution considering waves excited by point sources at the wavesource/medium boundary. The size and shape of the contact control the efficiency of excitation of spin waves and the type of convolution. Consider the lateral dimensions of the source parallel $a_{\parallel}$ and perpendicular $a_{\perp}$ to the static field. The source is assumed to efficiently excite waves with wavevector components $k_{\parallel} < \frac{\pi}{a_{\parallel}}$ and $k_{\perp} < \frac{\pi}{a_{\perp}}$, i.e. waves with wavelengths greater than the source size are not efficiently excited.
\subsection{Tailoring the spectrum of the excitation field}
Possibilities via control of spectrum of excitation. Directional emission for harmonic excitation. Convolution between spectrum of excitation field (e.g. harmonic $\rightarrow$ delta function) and slowness surface. This convolution is valid, as long as the coupling of the microwave field to the magnetization is constant over the support of the spectrum of microwave field.
\subsection{Time evolution}
Time evolution can be calculated in the linear regime by multiplication of a phase factor $e^{i \omega t}$ to the Fourier synthesis of the magnetization.
\subsection{Limits of the perturbative dispersion relation}
DE waves. Mode hybridization. Transverse modes.
% Q1: To what extent can damping be modelled as a convolution? How does one model harmonic excitation exciting a band of waves?

% Q2: Why does the width of the resonance curve correspond to the damping, i.e. decay length, of MSW? Is this measured?

\section{2D Green's functions for magnetostatic waves}
Validity of convolution as system operator---is magnetic medium under linearized L. L. equation an LTI system? Can we show that system of equations must admit a dispersion equation? An explicit dispersion equation?

The above approach is based on the explicit dispersion relation derived by K\&{}S in a perturbation theory. In reality, one should obtain the magnetostatic (magnetostatic-exchange) Green's function which solves the equations of motion: Maxwell's equations, electrodynamic boundary conditions, and linearized LLG. Showing that the magnetostatic operator is linear guarantees that an analysis on the basis of Fourier analysis and synthesis is applicable. Furthermore, (?) this shows the system operator is convolution. There is the possibility that one can show that MSW are an LTI system.

Then, using the Green's function, arbitrary sources maybe be modeled via convolution of the spectrum of the source structure and the spectrum of the driving field. 

In this approach, non-zero damping introduces a coupling between the eigenmodes, i.e. destroys the orthogonality of the eigenmodes, hindering an expansion of the field into the eigenmodes. Therefore, damping must be accounted for phenomenologically.
\subsection{System of equations}
The system of equations consists of Maxwell's equations, electromagnetic boundary conditions, and the linearized Landau-Lifshitz equation describing the medium.
\subsection{Point source emission pattern}

\subsection{Smeared point source}

\subsection{Finite wave source}

\subsection{Almost arbitrary driving field}

\subsection{Almost arbitrary driving field and finite wave source}

\subsection{Diffraction grating}

\section{Measuring magnetostatic waves, practical considerations}

\subsection{Sampling, mechanical restrictions}

\subsection{Scattering, optical restrictions}

%\section{\"Uber die Beugung Magnetostaticher Wellen hinaus}
%
%
%
%
%
%
\begin{thebibliography}{99}

% Kaiserslautern paper on diffraction of spin-waves
\bibitem{SD_kaiser_2000}
O. B\"uttner, M. Bauer, S. O. Demokritov, B. Hillebrands, Yuri S. Kivshar, V. Grimalsky, Yu. Rapoport, and A.N. Slavin, \\
Linear and non-linear diffraction of dipolar spin waves in yttrium iron garnet films observed by space- and time-resolved Brillouin light scattering.\\
{\it Phys. Rev. B} {\bf 61}, 11576 (2000).

% VS+Texas, experiment
\bibitem{VS_texas} 
V. E. Demidov, S. O. Demokritov, D. Birt, B. O'Gorman, M. Tsoi, and X. Li,\\
Radiation of spin waves from the open end of a microscopic magnetic-film waveguide.\\
{\it Phys. Rev. B} {\bf 80}, 014429 (2009).

% VS+Texas, apl
\bibitem{VS_texas_apl}
Daniel R. Birt, Brian O'Gorman, Maxim Tsoi, Xiaoqin Li, Vladislav E. Demidov, and Sergej O. Demokritov,\\
Diffraction of spin waves from a submicrometer-size defect in a microwaveguide.\\
{\it Appl. Phys. Lett.} {\bf 95}, 122510 (2009).

% VSS, stno experiment
\bibitem{VSS_stno} 
V.E. Demidov, S. Urazhdin and S.O. Demokritov,\\
Direct observation and mapping of spin waves emitted by spin-torque nano-oscillators.\\
{\it Nature Materials} {\bf 9}, 984-988 (2010).

% thomas
\bibitem{thomas}
T. Schneider, A. A. Serga, A. V. Chumak, C. W. Sandweg, S. Trudel, S. Wolff, M. P. Kostylev, V. S. Tiberkevich, A. N. Slavin, and B. Hillebrands,\\
Nondiffractive Subwavelength Wave Beams in a Medium with Externally Controlled Anisotropy.\\
{\it Phys. Rev. Lett.} {\bf 104}, 197203 (2010).

% Kalinikos theory, part 1
\bibitem{K_1980} 
B. A. Kalinikos,\\
Excitation of propagating spin waves in ferromagnetic films.\\
{\it IEE Proc. H} {\bf 127}, 4 (1980).

% Kalinikos theory, part 2
\bibitem{KS_1986}
B. A. Kalinikos and A. N. Slavin,\\
Theory of dipole-exchange spin-wave spectrum for ferromagnetic films with mixed exchange boundary conditions.\\ 
{\it J. Phys. C} {\bf 19}, 7013 (1986).

\end{thebibliography}
%
%
%
%
%
\appendix
\section{Appendix A: Group Velocity}
We derive the group velocity,
\begin{equation}
\vec{v}_{g} = \nabla_{\vec{k}} \omega_{n} (\vec{k}) = \frac{\partial \omega_{n}}{\partial k_{\zeta}} \hat{k}_{\zeta} + \frac{1}{k_{\zeta}} \frac{\partial \omega_{n}}{\partial \phi} \hat{\phi}
\end{equation}
first in polar coordinates.

We calculate the derivative $\frac{\partial \omega_{n}}{\partial k_{\zeta}} = \frac{1}{2 \omega_{n}} \frac{\partial \omega_{n}^2}{\partial k_{\zeta}}$ via $\frac{\partial \omega_{n}^2}{\partial k_{\zeta}}$. For notational convenience, we define 
\begin{align}
R &= \omega_{H} + \alpha \omega_{M} k_{n}^2 \\
%S &= \frac{\omega_{M} P_{nn} (1 - P_{nn}) \sin^2{\theta}}{R} \\
E &= \omega_{M} \sin^2{\theta} \sin^2{\phi}.
\end{align}
Then, we have
\begin{align}
\omega_{n} &= \sqrt{R(R + \omega_{M} F_{nn})} \\
\frac{\partial \omega_{n}^2}{\partial k_{\zeta}} &= 2  \alpha \omega_{M} k_{\zeta} \left[2R + \omega_{M} F_{nn} \right] + \omega_{M} R \frac{\partial F_{nn}}{\partial k_{\zeta}}.
\end{align}
Now, we calculate
\begin{align}
\frac{\partial P_{nn}}{\partial k_{\zeta}} &= 2 \frac{k_{\zeta}}{k_{n}^{2}} - 2 \frac{k_{\zeta}^3}{k_{n}^{4}} - 4 \frac{k_{\zeta}^3}{k_{n}^{4}}   F_{n} B + 4 \frac{k_{\zeta}^5}{k_{n}^{6}} F_{n} B - \frac{k_{\zeta}^4}{k_{n}^{4}} B \frac{\partial F_{n}}{\partial k_{\zeta}} \\
\frac{\partial F_{n}}{\partial k_{\zeta}} &= \frac{-2}{k_{\zeta}^2 L} + \frac{2 (-1)^n e^{-k_{\zeta} L}}{k_{\zeta}^2 L} + \frac{2 (-1)^n e^{-k_{\zeta} L}}{k_{\zeta}}
\end{align}
where we have defined $B = \frac{1}{2}$ if $n=0$ and $B=1$ if $n \neq 0$.
Now we have
\begin{align}
\frac{\partial F_{nn}}{\partial k_{\zeta}} &= \frac{\partial P_{nn}}{\partial k_{\zeta}} - \frac{\partial P_{nn}}{\partial k_{\zeta}} \sin^2{\theta} (1 + \cos^2{\phi}) - \frac{E P_{nn}}{R^2} \frac{\partial R}{\partial k_{\zeta}} + \\
&+ \frac{E}{R} \frac{\partial P_{nn}}{\partial k_{\zeta}}  + \frac{E P_{nn}^2}{R^2} \frac{\partial R}{\partial k_{\zeta}} - \frac{2 E P_{nn}}{R} \frac{\partial P_{nn}}{\partial k_{\zeta}} \nonumber
\end{align}
which yields $\frac{\partial \omega_{n}}{\partial k_{\zeta}}$. For $\frac{\partial \omega_{n}}{\partial \phi}$, we find
\begin{align}
\frac{\partial \omega_{n}}{\partial \phi} &= \frac{1}{2 \omega_{n}} \frac{\partial \omega_{n}^2}{\partial \phi} \\
\frac{\partial \omega_{n}^2}{\partial \phi} &= R \omega_{M} \frac{\partial F_{nn}}{\partial \phi} \\
\frac{\partial F_{nn}}{\partial \phi} &= P_{nn} \sin^2{\theta} \sin{2\phi} \left[ 1 + \frac{\omega_{M} (1 - P_{nn})}{\omega_{H} + \alpha \omega_{M} k_{n}^2} \right].
\end{align}
We may translate these results to rectangular coordinates. In that case, $\vec{v}_{g} = \nabla_{\vec{k}} \omega (\vec{k}) = \frac{\partial \omega_{n}}{\partial k_{z}} \hat{z} + \frac{\partial \omega_{n}}{\partial k_{y}} \hat{y}$. We have as relations
\begin{align}
k_{\zeta} &= \sqrt{k_{z}^2 + k_{y}^2} \\
k_{z} &= k_{\zeta} \cos{\phi} \\
k_{y} &= k_{\zeta} \sin{\phi}.
\end{align}
From the chain rule,
\begin{align}
\frac{\partial \omega_{n}}{\partial k_{z}} &= \frac{\partial \omega_{n}}{\partial k_{\zeta}} \cos{\phi} + \frac{\partial \omega_{n}}{\partial \phi} \left(\frac{-\sin{\phi}}{k_{\zeta}}\right) \\
\frac{\partial \omega_{n}}{\partial k_{y}} &= \frac{\partial \omega_{n}}{\partial k_{\zeta}} \sin{\phi} + \frac{\partial \omega_{n}}{\partial \phi} \left(\frac{\cos{\phi}}{k_{\zeta}}\right).
\end{align}

\section{Appendix B: Magnon Effective Mass}
Corpuscular picture, magnons. The magnon effective mass tensor has elements,
\begin{equation}
\left(\frac{1}{m}\right)_{\parallel , \perp} = \frac{1}{\hbar} \frac{\partial^2 \omega_{n}}{\partial k_{\parallel} \partial k_{\perp}}.
\end{equation}
Note that, besides the factor $\frac{1}{\hbar}$, the magnon effective mass tensor is the Hessian matrix of $\omega_{n} ( k_{\parallel} , k_{\perp} )$.

Once again, we proceed via $\frac{\partial^2 \omega_{n}}{\partial k_{\zeta}^2}$:
\begin{align}
\frac{\partial^2 \omega_{n}}{\partial k_{\zeta}^2} &= \frac{1}{2 \omega_{n}} \frac{\partial^2 \omega_{n}^2}{\partial k_{\zeta}^2} - \frac{1}{\omega_{n}} \left(\frac{\partial \omega_{n}}{\partial k_{\zeta}}\right)^2 \\
\frac{\partial^2 \omega_{n}^2}{\partial k_{\zeta}^2} &= \left[2R + \omega_{M} F_{nn} \right] \frac{\partial^2 R}{\partial k_{\zeta}^2} + R \omega_{M} \frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2} + \left[ 2 \frac{\partial R}{\partial k_{\zeta}} + 2 \omega_{M} \frac{\partial F_{nn}}{\partial k_{\zeta}} \right] \frac{\partial R}{\partial k_{\zeta}} \\
\frac{\partial^2 R}{\partial k_{\zeta}^2} &= 2 \alpha \omega_{M}.
\end{align}
We lack only $\frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}$. Having $\frac{\partial F_{nn}}{\partial k_{\zeta}}$, we proceed term-by-term,
\begin{align}
\frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2} &= \frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{1} + \frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{2} + \frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{3} + \frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{4} + \frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{5} + \frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{6} \\
\frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{1} &=\frac{\partial}{\partial k_{\zeta}} \frac{\partial P_{nn}}{\partial k_{\zeta}} = \frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2} \\
\frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{2} &= \frac{\partial}{\partial k_{\zeta}} \left[ - \frac{\partial P_{nn}}{\partial k_{\zeta}}  \sin^2{\theta} (1 + \cos^2{\phi}) \right] \\
&= - \frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2} \sin^2{\theta} (1 + \cos^2{\phi}) \\
\frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{3} &= \frac{\partial}{\partial k_{\zeta}} \left[-\frac{1}{R^2} E P_{nn} \frac{\partial R}{\partial k_{\zeta}} \right] \\
&= 2 E P_{nn} \left( \frac{\partial R}{\partial k_{\zeta}} \right)^2 \frac{1}{R^3} - \frac{1}{R^2} E \frac{\partial R}{\partial k_{\zeta}} \frac{\partial P_{nn}}{\partial k_{\zeta}} - \frac{1}{R^2} E P_{nn} \frac{\partial^2 R}{\partial k_{\zeta}^2} \\
\frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{4} &= \frac{\partial}{\partial k_{\zeta}} \left[ \frac{1}{R} E \frac{\partial P_{nn}}{\partial k_{\zeta}} \right] = - \frac{1}{R^2} E \frac{\partial P_{nn}}{\partial k_{\zeta}} \frac{\partial R}{\partial k_{\zeta}} + \frac{1}{R} E \frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2} \\
\frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{5} &= \frac{\partial}{\partial k_{\zeta}} \left[ \frac{1}{R^2} E P_{nn}^2 \frac{\partial R}{\partial k_{\zeta}} \right] \\
&= -2 \frac{1}{R^3} E P_{nn}^2 \left(\frac{\partial R}{\partial k_{\zeta}}\right)^2 + 2 \frac{1}{R^2} E P_{nn} \frac{\partial R}{\partial k_{\zeta}} \frac{\partial P_{nn}}{\partial k_{\zeta}} + \frac{1}{R^2} E P_{nn}^2 \frac{\partial^2 R}{\partial k_{\zeta}^2} \\
\frac{\partial^2 F_{nn}}{\partial k_{\zeta}^2}\bigg|_{6} &= \frac{\partial}{\partial k_{\zeta}} \left[-2 \frac{1}{R} E P_{nn} \frac{\partial P_{nn}}{\partial k_{\zeta}} \right] \\
&= 2 \frac{1}{R^2} E P_{nn} \frac{\partial R}{\partial k_{\zeta}} \frac{\partial P_{nn}}{\partial k_{\zeta}} - 2 \frac{1}{R} E \left(\frac{\partial P_{nn}}{\partial k_{\zeta}} \right)^2 - 2 \frac{1}{R} E P_{nn} \frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}.
\end{align}
Hence we need $\frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}$. Having $\frac{\partial P_{nn}}{\partial k_{\zeta}}$, we proceed term-by-term,
\begin{align}
\frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2} &= \frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}\bigg|_{1} + \frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}\bigg|_{2} + \frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}\bigg|_{3} + \frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}\bigg|_{4} + \frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}\bigg|_{5} \\
\frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}\bigg|_{1} &= \frac{\partial}{\partial k_{\zeta}} \left[2 \frac{k_{\zeta}}{k_{n}^2} \right] = \frac{2}{k_{n}^2} - 4 \frac{k_{\zeta}}{k_{n}^3} \frac{\partial k_{n}}{\partial k_{\zeta}} \\
\frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}\bigg|_{2} &= \frac{\partial}{\partial k_{\zeta}} \left[-2 \frac{k_{\zeta}^2}{k_{n}^3} \frac{\partial k_{n}}{\partial k_{\zeta}} \right] \\
&= - 4 \frac{k_{\zeta}}{k_{n}^3} \frac{\partial k_{n}}{\partial k_{\zeta}} + 6 \frac{k_{\zeta}^2}{k_{n}^4} \left(\frac{\partial k_{n}}{\partial k_{\zeta}} \right)^2 - 2 \frac{k_{\zeta}^2}{k_{n}^3} \frac{\partial^2 k_{n}}{\partial k_{\zeta}^2} \\
\frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}\bigg|_{3} &= \frac{\partial}{\partial k_{\zeta}} \left[-4 \frac{k_{\zeta}^3}{k_{n}^4} F_{n} B \right] \\
&= -12 \frac{k_{\zeta}^2}{k_{n}^4} F_{n} B + 16 \frac{k_{\zeta}^3}{k_{n}^5} F_{n} B \frac{\partial k_{n}}{\partial k_{\zeta}} - 4 \frac{k_{\zeta}^3}{k_{n}^4} B \frac{\partial F_{n}}{\partial k_{\zeta}} \\
\frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}\bigg|_{4} &= \frac{\partial}{\partial k_{\zeta}} \left[ 4 \frac{k_{\zeta}^4}{k_{n}^5} F_{n} B \frac{\partial k_{n}}{\partial k_{\zeta}} \right] \\
&= 16 \frac{k_{\zeta}^3}{k_{n}^5} F_{n} B \frac{\partial k_{n}}{\partial k_{\zeta}} - 20 \frac{k_{\zeta}^4}{k_{n}^6} F_{n} B \left( \frac{\partial k_{n}}{\partial k_{\zeta}} \right)^2 + 4 \frac{k_{\zeta}^4}{k_{n}^5} B \frac{\partial k_{n}}{\partial k_{\zeta}} \frac{\partial F_{n}}{\partial k_{\zeta}} + 4 \frac{k_{\zeta}^4}{k_{n}^5} F_{n} B \frac{\partial^2 k_{n}}{\partial k_{\zeta}^2} \\
\frac{\partial^2 P_{nn}}{\partial k_{\zeta}^2}\bigg|_{5} &= \frac{\partial}{\partial k_{\zeta}} \left[ - \frac{k_{\zeta}^4}{k_{n}^4} B \frac{\partial F_{n}}{\partial k_{\zeta}} \right] \\
&= -4 \frac{k_{\zeta}^3}{k_{n}^4} B \frac{\partial F_{n}}{\partial k_{\zeta}} + 4 \frac{k_{\zeta}^4}{k_{n}^5} B \frac{\partial F_{n}}{\partial k_{\zeta}} \frac{\partial k_{n}}{\partial k_{\zeta}} - \frac{k_{\zeta}^4}{k_{n}^4} B \frac{\partial^2 F_{n}}{\partial k_{\zeta}^2}.
\end{align}
To conclude, we calculate $\frac{\partial^2 F_{n}}{\partial k_{\zeta}^2}$,
\begin{align}
\frac{\partial^2 F_{n}}{\partial k_{\zeta}^2} &= \frac{\partial^2 F_{n}}{\partial k_{\zeta}^2}\bigg|_{1} + \frac{\partial^2 F_{n}}{\partial k_{\zeta}^2}\bigg|_{2} + \frac{\partial^2 F_{n}}{\partial k_{\zeta}^2}\bigg|_{3} \\
\frac{\partial^2 F_{n}}{\partial k_{\zeta}^2}\bigg|_{1} &= \frac{\partial}{\partial k_{\zeta}} \left[-2 \frac{1}{k_{\zeta}^2L} \right]= 4 \frac{1}{k_{\zeta}^3 L} \\
\frac{\partial^2 F_{n}}{\partial k_{\zeta}^2}\bigg|_{2} &= \frac{\partial}{\partial k_{\zeta}} \left[ 2 (-1)^n \frac{1}{k_{\zeta}^2 L} e^{-k_{\zeta} L } \right] \\
&= -4 (-1)^n \frac{1}{k_{\zeta}^3 L} e^{-k_{\zeta} L} - 2 (-1)^n \frac{1}{k_{\zeta}^2} e^{- k_{\zeta} L} \\
\frac{\partial^2 F_{n}}{\partial k_{\zeta}^2}\bigg|_{3} &= \frac{\partial}{\partial k_{\zeta}} \left[ 2 (-1)^n \frac{1}{k_{\zeta}} e^{- k_{\zeta} L } \right] \\
&= -2 (-1)^n \frac{1}{k_{\zeta}^2} e^{- k_{\zeta} L } - 2L (-1)^n \frac{1}{k_{\zeta}} e^{- k_{\zeta} L}.
\end{align}
Note the derivative of $k_{n}$ with respect to $k_{\zeta}$,
\begin{align}
\frac{\partial k_{n}}{\partial k_{\zeta}} &= \frac{k_{\zeta}}{k_{n}} \\
\frac{\partial^2 k_{n}}{\partial k_{\zeta}^2} &= \frac{1}{k_{n}} - \frac{k_{\zeta}^2}{k_{n}^3}.
\end{align}
Now, we calculate $\frac{\partial^2 \omega_{n}}{\partial \phi^2}$,
\begin{align}
\frac{\partial^2 \omega_{n}}{\partial \phi^2} &= \frac{1}{2 \omega_{n}} \frac{\partial^2 \omega_{n}^2}{\partial \phi^2} - \frac{1}{\omega_{n}} \left(\frac{\partial \omega_{n}}{\partial \phi}\right)^2 \\
\frac{\partial^2 \omega_{n}^2}{\partial \phi^2} &= R \omega_{M} \frac{\partial^2 F_{nn}}{\partial \phi^2} \\
\frac{\partial^2 F_{nn}}{\partial \phi^2} &= 2 \cos{2\phi} \left( P_{nn} \sin^2{\theta} + \frac{\omega_{M} P_{nn} (1-P_{nn}) \sin^2{\theta}}{R} \right).
\end{align}
Finally the mixed-derivatives,
\begin{align}
\frac{\partial^2 \omega_{n}}{\partial k_{\zeta} \partial \phi} &= \frac{\partial^2 \omega_{n}}{\partial \phi \partial k_{\zeta}} = \frac{\partial}{\partial k_{\zeta}} \frac{\partial \omega_{n}}{\partial \phi} = \frac{\partial}{\partial k_{\zeta}} \left[\frac{1}{2 \omega_{n}} \frac{\partial \omega_{n}^2}{\partial \phi} \right] \\
&= \frac{\partial}{\partial k_{\zeta}} \left[\frac{1}{2 \omega_{n}} R P_{nn} \omega_{M} \sin{2\phi} \sin^2{\theta} + \frac{1}{2 \omega_{n}} R \omega_{M}^2 \sin{2 \phi} \frac{P_{nn} (1 - P_{nn}) \sin^2{\theta}}{R} \right] \\
\frac{\partial^2 \omega_{n}}{\partial k_{\zeta} \partial \phi} &= \frac{\partial^2 \omega_{n}}{\partial k_{\zeta} \partial \phi}\bigg|_{1} + \frac{\partial^2 \omega_{n}}{\partial k_{\zeta} \partial \phi}\bigg|_{2} \\
\frac{\partial^2 \omega_{n}}{\partial k_{\zeta} \partial \phi}\bigg|_{1} &= \frac{-T}{2 \omega_{n}^2} R P_{nn} \frac{\partial \omega_{n}}{\partial k_{\zeta}} + \frac{T}{2 \omega_{n}} P_{nn} \frac{\partial R}{\partial k_{\zeta}} + \frac{T}{2 \omega_{n}} R \frac{\partial P_{nn}}{\partial k_{\zeta}} \\
\frac{\partial^2 \omega_{n}}{\partial k_{\zeta} \partial \phi}\bigg|_{2} &= \frac{- U}{2\omega_{n}^2} \left[P_{nn} - P_{nn}^2 \right] \frac{\partial \omega_{n}}{\partial k_{\zeta}} + \frac{U}{2 \omega_{n}} \frac{\partial P_{nn}}{\partial k_{\zeta}} \left[1 - 2 P_{nn} \right].
\end{align}
The variables $T$ and $U$ have been defined for notational brevity:
\begin{align}
T &= \omega_{M} \sin{2 \phi} \sin^2{\theta} \\
U &= \omega_{M}^2 \sin{2 \phi} \sin^2{\theta}.
\end{align}
To write down the Hessian matrix, we convert these results to Cartesian coordinates via
\begin{align}
\frac{\partial^2 \omega_{n}}{\partial k_{z}^2} &= \frac{\partial^2 \omega_{n}}{\partial k_{z} \partial k_{\zeta}} \frac{\partial k_{\zeta}}{\partial k_{z}} + \frac{\partial^2 \omega_{n}}{\partial k_{z} \partial \phi} \frac{\partial \phi}{\partial k_{z}} + \frac{\partial \omega_{n}}{\partial k_{\zeta}} \frac{\partial^2 k_{\zeta}}{\partial k_{z}^2} + \frac{\partial \omega_{n}}{\partial \phi} \frac{\partial^2 \phi}{\partial k_{z}^2} \\
\frac{\partial^2 \omega_{n}}{\partial k_{y}^2} &= \frac{\partial^2 \omega_{n}}{\partial k_{y} \partial k_{\zeta}} \frac{\partial k_{\zeta}}{\partial k_{y}} + \frac{\partial^2 \omega_{n}}{\partial k_{y} \partial \phi} \frac{\partial \phi}{\partial k_{y}} + \frac{\partial \omega_{n}}{\partial k_{\zeta}} \frac{\partial^2 k_{\zeta}}{\partial k_{y}^2} + \frac{\partial \omega_{n}}{\partial \phi} \frac{\partial^2 \phi}{\partial k_{y}^2} \\
\frac{\partial^2 \omega_{n}}{\partial k_{z} \partial k_{y}} &= \frac{\partial^2 \omega_{n}}{\partial k_{z} \partial k_{\zeta}} \frac{\partial k_{\zeta}}{\partial k_{y}} + \frac{\partial^2 \omega_{n}}{\partial k_{z} \partial \phi} \frac{\partial \phi}{\partial k_{y}} + \frac{\partial \omega_{n}}{\partial k_{\zeta}} \frac{\partial^2 k_{\zeta}}{\partial k_{z} \partial k_{y}} + \frac{\partial \omega_{n}}{\partial \phi} \frac{\partial^2 \phi}{\partial k_{z} \partial k_{y}} \\
\frac{\partial^2 \omega_{n}}{\partial k_{z} \partial k_{y}} &= \frac{\partial^2 \omega_{n}}{\partial k_{y} \partial k_{z}}.
\end{align}
Hence we need
\begin{align}
\frac{\partial^2 \omega_{n}}{\partial k_{z} \partial k_{\zeta}} &= \frac{\partial k_{\zeta}}{\partial k_{z}} \frac{\partial^2 \omega_{n}}{\partial k_{\zeta}^2} + \frac{\partial \phi}{\partial k_{z}} \frac{\partial^2 \omega_{n}}{\partial k_{\zeta} \partial \phi} \\
\frac{\partial^2 \omega_{n}}{\partial k_{z} \partial \phi} &= \frac{\partial k_{\zeta}}{\partial k_{z}} \frac{\partial^2 \omega_{n}}{\partial k_{\zeta} \partial \phi} + \frac{\partial \phi}{\partial k_{z}} \frac{\partial^2 \omega_{n}}{\partial \phi^2} \\
\frac{\partial k_{\zeta}}{\partial k_{z}} &= \cos{\phi} \\
\frac{\partial k_{\zeta}}{\partial k_{y}} &= \sin{\phi} \\
\frac{\partial^2 k_{\zeta}}{\partial k_{z}^2} &= \frac{\sin^2{\phi}}{k_{\zeta}} \\
\frac{\partial^2 k_{\zeta}}{\partial k_{y}^2} &= \frac{\cos^2{\phi}}{k_{\zeta}} \\
\frac{\partial^2 k_{\zeta}}{\partial k_{y} \partial k_{z}} &= \frac{\partial^2 k_{\zeta}}{\partial k_{z} \partial k_{y}} = \frac{-\cos{\phi} \sin{\phi}}{k_{\zeta}} \\
\frac{\partial \phi}{\partial k_{z}} &= \frac{- \sin{\phi}}{k_{\zeta}} \\
\frac{\partial \phi}{\partial k_{y}} &= \frac{\cos{\phi}}{k_{\zeta}} \\
\frac{\partial^2 \phi}{\partial k_{z}^2} &= \frac{\sin{2 \phi}}{k_{\zeta}^2} \\
\frac{\partial^2 \phi}{\partial k_{y}^2} &= \frac{-\sin{2 \phi}}{k_{\zeta}^2} \\
\frac{\partial^2 \phi}{\partial k_{y} \partial k_{z}} &= \frac{\partial^2 \phi}{\partial k_{z} \partial k_{y}} = \frac{1 - 2\cos^2{\phi}}{k_{\zeta}^2}
\end{align}

\section{Appendix C: Gyrotopy and Angular Dependence of $\omega_{n} (\vec{k})$}

\section{Appendix D: Linearity of MSW operator}

\section{Appendix E: Aside, the SHM}

\end{document}

% Figure and Figure Reference example
%The resultant plot appears in Fig. \ref{fwhm_ampl} and as a log-log graph in Fig. \ref{fwhm_ampl_log}.
%\begin{figure}
%  \centering
%  \includegraphics[angle=-90,width=100mm]{fwhm_ampl_log.eps}
%  \caption{Peak amplitude of $\| \chi_{xx} \|^2$ as a function of linewidth, log-log plot. \label{fwhm_ampl_log}}
%\end{figure}

%Expression for P_{nn} in non-diagonal approximation...
%\begin{equation}
%P_{nn^{\prime}} = \frac{k_{\zeta}^2}{k_{n^{\prime}}^2} \delta_{nn^{\prime}} - \frac{k_{\zeta}^4}{k_{n}^2 k_{n^{\prime}}^2} F_{n} \frac{1}{[(1 + \delta_{0n})(1+\delta_{0n^{\prime}})]^{1/2}} \left(\frac{1 + (-1)^{n + n^{\prime}}}{2} \right)
%\end{equation}

% \frac{\partial k_{n}}{\partial k_{\zeta}} &= \frac{k_{\zeta}}{k_{n}} \\
%\frac{\partial P_{nn}}{\partial k_{\zeta}} &= 2 k_{\zeta} k_{n}^{-2} - 2 k_{\zeta}^2 k_{n}^{-3} \frac{\partial k_{n}}{\partial k_{\zeta}} - 4 k_{\zeta}^3 k_{n}^{-4} F_{n} B +  \\
%&+ 4 k_{\zeta} k_{n}^{-5} F_{n} B \frac{\partial k_{n}}{\partial k_{\zeta}} - k_{\zeta}^4 k_{n}^{-4} B \frac{\partial F_{n}}{\partial k_{\zeta}}